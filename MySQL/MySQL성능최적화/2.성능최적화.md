## 성능 스키마

- MySQL 서버 내에서 실행되는 작업에 대한 상세한 메트릭을 제공한다.

### Instrument

- 정보를 얻고자 하는 MySQL의 코드의 어떤 부분

### consumer

- 어떤 코드가 수행되었는지에 대한 정보를 저장하는 단순한 테이블
- 쿼리를 수행하면 컨슈머는 총 실행횟수, 인덱스가 사용되지 않은 횟수, 수행시간 등을 기록함

### 스레드 이해하기

- MySQL서버는 멀티 스레드 방식의 소프트웨어
- 각 구성요소는 스레드를 사용한다
- 메인 스레드나 스토리지 엔진에 의해 생성된 백그라운드 스레드이거나 사용자 연결을 위해 생성된 포그라운드 스레드일수도 있다!

## 성능 스키마 언제쓸까?

- 일반 SQL구문 모니터링
- 읽기 바운드 작업인지 쓰기 바운드 작업인지 확인할 때 유용
  - select 쿼리수가 많으면 -> 읽기 쿼리임을 확인할 수 있다.
  - 구문의 대기 시간을 알고 싶으면 lock_time으로 집계할수 있다!
  - 다이제스트 테이블?
    - **다이제스트 테이블(Digest Table)** 은 쿼리 성능 분석과 관련된 테이블로, 주로 **Performance Schema**에서 제공하는 `events_statements_summary_by_digest` 테이블을 의미
- 변수 점검
  - 변수는 서버변수, 상태변수로 나뉘는데 상태변수는 사용자계정, 호스트, 스레드 별로 집계할 수 있다.
  - 스레드 기준으로 집계하면 어떤 연결이 서버의 리소스를 가장 빨리 사용하는지 식별할 수 있다.

```
select * from status_by_thread where variable_name = 'handler_write';
```
